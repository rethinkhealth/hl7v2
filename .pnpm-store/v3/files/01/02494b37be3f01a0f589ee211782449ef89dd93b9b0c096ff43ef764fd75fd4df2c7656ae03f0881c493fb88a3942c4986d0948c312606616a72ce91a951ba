{"version":3,"file":"fiberRefs.js","names":["Arr","_interopRequireWildcard","require","Equal","_Function","HashSet","Option","_Pipeable","core","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","unsafeMake","fiberRefLocals","FiberRefsImpl","empty","Map","FiberRefsSym","exports","Symbol","for","locals","constructor","pipe","pipeArguments","arguments","findAncestor","_ref","_parentStack","_childStack","_childModified","ref","parentStack","childStack","childModified","ret","undefined","isNonEmptyReadonlyArray","parentFiberId","headNonEmpty","parentAncestors","tailNonEmpty","childFiberId","childRefValue","childAncestors","startTimeMillis","id","initial","joinAs","dual","self","fiberId","that","parentFiberRefs","forEach","fiberRef","childValue","symbol","equals","join","ancestor","wasModified","patch","diff","oldValue","newValue","newStack","slice","forkAs","childId","map","unsafeForkAs","stack","fork","fiberRefs","fromIterable","keys","setAll","forEachSequentialDiscard","fiberRefSet","getOrDefault","delete_","delete","none","some","getOrElse","updateAs","value","size","unsafeUpdateAs","oldStack","currentId","currentValue","updateManyAs","entries","values","length"],"sources":["../../../src/internal/fiberRefs.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]}